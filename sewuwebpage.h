String message, XML;

// SEWU AUDIO - Running Text Display System
// Simple Web UI with Dark Theme

const char webpage[] PROGMEM = R"=====(
<!DOCTYPE HTML><html><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>SEWU AUDIO Control</title><style>*{margin:0;padding:0;box-sizing:border-box}:root{--bg:#0a0a0a;--card:#1a1a1a;--accent:#f59e0b;--accent2:#10b981;--text:#f5f5f5;--text-dim:#9ca3af;--border:#2a2a2a;--dirty:#ef4444}body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:linear-gradient(135deg,#0a0a0a 0%,#1a1a1a 100%);color:var(--text);padding:0;min-height:100vh;padding-top:44px}.marquee-wrap{position:fixed;top:0;left:0;right:0;z-index:1000;background:linear-gradient(90deg,#f59e0b 0%,#fbbf24 25%,#f59e0b 50%,#fbbf24 75%,#f59e0b 100%);background-size:200% 100%;animation:shimmer 3s linear infinite;padding:12px 0;box-shadow:0 4px 20px rgba(245,158,11,.4)}.marquee{overflow:hidden;white-space:nowrap}.marquee-content{display:inline-block;animation:scroll 20s linear infinite;font-size:14px;font-weight:700;color:#000;text-shadow:0 1px 2px rgba(255,255,255,.3)}.marquee-content span{margin:0 50px}.marquee-icon{font-size:16px}@keyframes scroll{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}@keyframes shimmer{0%{background-position:200% 0}100%{background-position:-200% 0}}.header{background:linear-gradient(135deg,#1a1a1a 0%,#0f0f0f 100%);border-bottom:3px solid var(--accent);padding:25px 20px;text-align:center;box-shadow:0 4px 20px rgba(245,158,11,.2)}.header h1{background:linear-gradient(135deg,#f59e0b 0%,#fbbf24 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;font-size:28px;font-weight:800;margin:0;letter-spacing:1px}.header .tagline{color:var(--text-dim);font-size:13px;margin-top:8px;font-weight:500}.status{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:15px}.status-item{background:rgba(245,158,11,.1);border:1px solid rgba(245,158,11,.3);padding:12px;border-radius:8px;text-align:center}.status-label{color:var(--text-dim);font-size:11px;text-transform:uppercase;letter-spacing:.5px}.status-value{color:var(--accent);font-size:20px;font-weight:700;margin-top:4px}.container{max-width:700px;margin:0 auto;padding:20px}.section{background:var(--card);border-radius:12px;padding:20px;margin-bottom:16px;border:1px solid var(--border);box-shadow:0 4px 15px rgba(0,0,0,.3)}.section-title{color:var(--accent);font-size:18px;font-weight:700;margin-bottom:16px;padding-bottom:12px;border-bottom:2px solid rgba(245,158,11,.2);display:flex;align-items:center;gap:8px}.grid{display:grid;gap:16px}.grid-2{grid-template-columns:repeat(2,1fr)}.form-group{display:flex;flex-direction:column;gap:6px}label{color:var(--text-dim);font-size:13px;font-weight:600}input,select{background:var(--bg);color:var(--text);border:1px solid var(--border);padding:12px;border-radius:6px;font-size:14px;transition:all .3s}input:focus,select:focus{outline:0;border-color:var(--accent);box-shadow:0 0 0 3px rgba(245,158,11,.1)}input.dirty,select.dirty{border-color:var(--dirty);box-shadow:0 0 0 2px rgba(239,68,68,.2)}input[type="range"]{height:6px;background:var(--border);border:none;padding:0;cursor:pointer}input[type="range"]::-webkit-slider-thumb{-webkit-appearance:none;width:20px;height:20px;background:linear-gradient(135deg,#f59e0b,#fbbf24);border-radius:50%;cursor:pointer;box-shadow:0 2px 8px rgba(245,158,11,.5)}input[type="range"]::-moz-range-thumb{width:20px;height:20px;background:linear-gradient(135deg,#f59e0b,#fbbf24);border-radius:50%;cursor:pointer;border:none;box-shadow:0 2px 8px rgba(245,158,11,.5)}.btn{background:linear-gradient(135deg,#f59e0b 0%,#fbbf24 100%);color:#000;border:none;padding:14px 24px;border-radius:8px;font-size:14px;font-weight:700;cursor:pointer;transition:all .3s;text-transform:uppercase;letter-spacing:1px;margin-top:20px;width:100%;box-shadow:0 4px 15px rgba(245,158,11,.3)}.btn:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(245,158,11,.5)}.btn:active{transform:translateY(0)}.mode-toggle{display:grid;grid-template-columns:1fr 1fr;gap:12px}.mode-btn{padding:16px;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;transition:all .3s;text-align:center;border:2px solid var(--border);background:var(--bg);color:var(--text-dim)}.mode-btn.active{background:linear-gradient(135deg,#f59e0b 0%,#fbbf24 100%);color:#000;border-color:var(--accent);box-shadow:0 4px 15px rgba(245,158,11,.4)}.mode-btn:hover{border-color:var(--accent)}.mode-desc{font-size:11px;margin-top:6px;opacity:.8}.brightness-value{text-align:center;font-size:40px;color:var(--accent);font-weight:800;margin:15px 0}.success{background:rgba(16,185,129,.2);border:1px solid var(--accent2);color:var(--accent2);padding:12px;border-radius:6px;text-align:center;display:none;margin-top:12px;font-weight:600}.unsaved-hint{color:var(--dirty);font-size:11px;margin-top:4px;display:none}.footer{text-align:center;padding:30px 20px;color:var(--text-dim);font-size:12px;border-top:1px solid var(--border);margin-top:20px}.footer-brand{font-weight:700;color:var(--accent);font-size:14px;margin-bottom:5px}@media(max-width:600px){.grid-2{grid-template-columns:1fr}.header h1{font-size:24px}}</style></head><body onload='init()'><div class="marquee-wrap"><div class="marquee"><div class="marquee-content" id="marqueeText"><span class="marquee-icon">üì¢</span> <span>Loading...</span></div></div></div><div class="header"><h1>‚ö° SEWU AUDIO</h1><div class="tagline">Sound System & Lighting Control Panel</div><div class="status"><div class="status-item"><div class="status-label">Waktu</div><div class="status-value" id="time">--:--:--</div></div><div class="status-item"><div class="status-label">Tanggal</div><div class="status-value" id="date">--/--</div></div><div class="status-item"><div class="status-label">Suhu</div><div class="status-value" id="temp">--¬∞C</div></div></div></div><div class="container"><div class="section"><div class="section-title">üé¨ Mode Display</div><div class="mode-toggle"><div class="mode-btn" id="modeNormal" onclick="setMode(0)"><div>üïê Normal Mode</div><div class="mode-desc">Jam, Tanggal, Suhu, Running Text</div></div><div class="mode-btn" id="modeRunning" onclick="setMode(1)"><div>üìù Running Text Only</div><div class="mode-desc">Info 1, 2, 3 Full Layar</div></div></div><div id="msg6" class="success">‚úì Mode berhasil diubah!</div></div><div class="section"><div class="section-title">üéØ Nama Sistem</div><div class="form-group"><label>Nama Display</label><input type="text" id="nama" maxlength="63" placeholder="SEWU AUDIO" oninput="markDirty('nama')"><div class="unsaved-hint" id="hint_nama">‚ö† Belum disimpan</div></div><button class="btn" onclick="saveNama()">üíæ Simpan Nama</button><div id="msg1" class="success">‚úì Nama berhasil disimpan!</div></div><div class="section"><div class="section-title">üìù Running Text (Info 1, 2, 3)</div><div class="grid"><div class="form-group"><label>Info 1</label><input type="text" id="info1" maxlength="256" placeholder="selamat datang di hajatan sewu audio" oninput="markDirty('info1')"><div class="unsaved-hint" id="hint_info1">‚ö† Belum disimpan</div></div><div class="form-group"><label>Info 2</label><input type="text" id="info2" maxlength="256" placeholder="selamat menikmati" oninput="markDirty('info2')"><div class="unsaved-hint" id="hint_info2">‚ö† Belum disimpan</div></div><div class="form-group"><label>Info 3</label><input type="text" id="info3" maxlength="256" placeholder="sewu audio sound system and lighting" oninput="markDirty('info3')"><div class="unsaved-hint" id="hint_info3">‚ö† Belum disimpan</div></div></div><button class="btn" onclick="saveRunningText()">üíæ Simpan Running Text</button><div id="msg2" class="success">‚úì Running Text disimpan!</div></div><div class="section"><div class="section-title">‚è∞ Pengaturan Waktu RTC</div><div class="grid grid-2"><div class="form-group"><label>üìÖ Tanggal</label><input type="date" id="dateInput"></div><div class="form-group"><label>üïê Jam</label><input type="time" id="timeInput"></div></div><button class="btn" onclick="saveDateTime()">‚è∞ Atur Waktu</button><div id="msg3" class="success">‚úì Waktu berhasil diatur!</div></div><div class="section"><div class="section-title">üñ•Ô∏è Pengaturan Display</div><div class="form-group"><label>Jumlah Panel P10</label><select id="panelCount" onchange="markDirty('panelCount')"><option value="1">1 Panel (32x16)</option><option value="2">2 Panel (64x16)</option><option value="3">3 Panel (96x16)</option><option value="4">4 Panel (128x16)</option></select><div class="unsaved-hint" id="hint_panelCount">‚ö† Belum disimpan</div></div><div class="form-group" style="margin-top:20px"><label style="display:flex;justify-content:space-between"><span>üåô Redup</span><span>‚òÄÔ∏è Cerah</span></label><input type="range" id="cerah" min="18" max="255" value="128" oninput="updateBright();markDirty('cerah')"><div class="unsaved-hint" id="hint_cerah">‚ö† Belum disimpan</div></div><div class="brightness-value" id="brightVal">128</div><button class="btn" onclick="saveDisp()">üíæ Simpan Pengaturan Display</button><div id="msg4" class="success">‚úì Display disimpan!</div></div><div class="section"><div class="section-title">üì∂ Pengaturan WiFi AP</div><div class="grid"><div class="form-group"><label>SSID Access Point</label><input type="text" id="wifissid" maxlength="63" placeholder="SEWU AUDIO" oninput="markDirty('wifissid')"><div class="unsaved-hint" id="hint_wifissid">‚ö† Belum disimpan</div></div><div class="form-group"><label>üîë Password (min 8 karakter)</label><input type="text" id="wifipass" maxlength="63" placeholder="sewuaudio123" oninput="markDirty('wifipass')"><div class="unsaved-hint" id="hint_wifipass">‚ö† Belum disimpan</div></div></div><button class="btn" onclick="saveWifi()">üíæ Simpan & Restart</button><div id="msg5" class="success">‚úì WiFi disimpan! Restarting...</div></div></div><div class="footer"><div class="footer-brand">‚ö° SEWU AUDIO</div>¬© 2024 SEWU AUDIO - Sound System & Lighting</div><script>var x;var dirty={};var serverData={};var currentMode=0;function init(){x=new XMLHttpRequest();loadData();setInterval(loadData,2000)}function loadData(){if(!x||x.readyState==0||x.readyState==4){x.open('PUT','xml',true);x.onreadystatechange=function(){if(x.readyState==4&&x.status==200){var r=x.responseXML;document.getElementById('time').innerHTML=pad(r.getElementsByTagName('rHour')[0].firstChild.nodeValue)+':'+pad(r.getElementsByTagName('rMinute')[0].firstChild.nodeValue)+':'+pad(r.getElementsByTagName('rSecond')[0].firstChild.nodeValue);document.getElementById('date').innerHTML=r.getElementsByTagName('rDay')[0].firstChild.nodeValue+'/'+r.getElementsByTagName('rMonth')[0].firstChild.nodeValue;document.getElementById('temp').innerHTML=r.getElementsByTagName('rTemp')[0].firstChild.nodeValue+'¬∞C';serverData.nama=r.getElementsByTagName('rNama')[0].firstChild.nodeValue;serverData.info1=r.getElementsByTagName('rInfo1')[0].firstChild.nodeValue;serverData.info2=r.getElementsByTagName('rInfo2')[0].firstChild.nodeValue;serverData.info3=r.getElementsByTagName('rInfo3')[0].firstChild.nodeValue;serverData.wifissid=r.getElementsByTagName('rWifissid')[0].firstChild.nodeValue;serverData.wifipass=r.getElementsByTagName('rWifipass')[0].firstChild.nodeValue;serverData.cerah=r.getElementsByTagName('rCerah')[0].firstChild.nodeValue;serverData.panelCount=r.getElementsByTagName('rPanelCount')[0].firstChild.nodeValue;serverData.displayMode=r.getElementsByTagName('rDisplayMode')[0].firstChild.nodeValue;currentMode=parseInt(serverData.displayMode);updateModeButtons();updateMarquee();if(!dirty.nama)document.getElementById('nama').value=serverData.nama;if(!dirty.info1)document.getElementById('info1').value=serverData.info1;if(!dirty.info2)document.getElementById('info2').value=serverData.info2;if(!dirty.info3)document.getElementById('info3').value=serverData.info3;if(!dirty.wifissid)document.getElementById('wifissid').value=serverData.wifissid;if(!dirty.wifipass)document.getElementById('wifipass').value=serverData.wifipass;if(!dirty.cerah){document.getElementById('cerah').value=serverData.cerah;updateBright()}if(!dirty.panelCount)document.getElementById('panelCount').value=serverData.panelCount}};x.send(null)}}function updateModeButtons(){document.getElementById('modeNormal').classList.toggle('active',currentMode==0);document.getElementById('modeRunning').classList.toggle('active',currentMode==1)}function setMode(mode){currentMode=mode;updateModeButtons();var data={cerah:serverData.cerah||document.getElementById('cerah').value,panelCount:serverData.panelCount||document.getElementById('panelCount').value,displayMode:mode};var xhr=new XMLHttpRequest();xhr.open('POST','/settingdisp',true);xhr.setRequestHeader('Content-Type','application/json');xhr.onload=function(){if(xhr.status==200){showMsg('msg6');setTimeout(loadData,500)}};xhr.send(JSON.stringify(data))}function updateMarquee(){var m=document.getElementById('marqueeText');m.innerHTML='<span class="marquee-icon">üì¢</span> <span>'+serverData.info1+'</span> <span class="marquee-icon">‚≠ê</span> <span>'+serverData.info2+'</span> <span class="marquee-icon">üéµ</span> <span>'+serverData.info3+'</span> <span class="marquee-icon">‚ú®</span>'}function pad(n){return n<10?'0'+n:n}function updateBright(){document.getElementById('brightVal').textContent=document.getElementById('cerah').value}function markDirty(id){dirty[id]=true;var el=document.getElementById(id);var hint=document.getElementById('hint_'+id);if(el)el.classList.add('dirty');if(hint)hint.style.display='block'}function clearDirty(ids){ids.forEach(function(id){dirty[id]=false;var el=document.getElementById(id);var hint=document.getElementById('hint_'+id);if(el)el.classList.remove('dirty');if(hint)hint.style.display='none'})}function showMsg(id){var m=document.getElementById(id);m.style.display='block';setTimeout(function(){m.style.display='none'},3000)}function saveDateTime(){var d=document.getElementById('dateInput').value;var t=document.getElementById('timeInput').value;if(d)window.location.href='/?date='+d;if(t)window.location.href='/?time='+t;showMsg('msg3')}function saveNama(){var data={nama:document.getElementById('nama').value,info1:serverData.info1||'',info2:serverData.info2||'',info3:serverData.info3||''};var xhr=new XMLHttpRequest();xhr.open('POST','/settinginfo',true);xhr.setRequestHeader('Content-Type','application/json');xhr.onload=function(){if(xhr.status==200){clearDirty(['nama']);showMsg('msg1');setTimeout(loadData,500)}};xhr.send(JSON.stringify(data))}function saveRunningText(){var data={nama:serverData.nama||document.getElementById('nama').value,info1:document.getElementById('info1').value,info2:document.getElementById('info2').value,info3:document.getElementById('info3').value};var xhr=new XMLHttpRequest();xhr.open('POST','/settinginfo',true);xhr.setRequestHeader('Content-Type','application/json');xhr.onload=function(){if(xhr.status==200){clearDirty(['info1','info2','info3']);showMsg('msg2');setTimeout(loadData,500)}};xhr.send(JSON.stringify(data))}function saveWifi(){var pass=document.getElementById('wifipass').value;if(pass.length>0&&pass.length<8){alert('Password harus minimal 8 karakter!');return}var data={wifissid:document.getElementById('wifissid').value,wifipass:pass};var xhr=new XMLHttpRequest();xhr.open('POST','/settingwifi',true);xhr.setRequestHeader('Content-Type','application/json');xhr.onload=function(){if(xhr.status==200){clearDirty(['wifissid','wifipass']);showMsg('msg5')}};xhr.send(JSON.stringify(data))}function saveDisp(){var data={cerah:document.getElementById('cerah').value,panelCount:document.getElementById('panelCount').value,displayMode:currentMode};var xhr=new XMLHttpRequest();xhr.open('POST','/settingdisp',true);xhr.setRequestHeader('Content-Type','application/json');xhr.onload=function(){if(xhr.status==200){clearDirty(['cerah','panelCount']);showMsg('msg4')}};xhr.send(JSON.stringify(data))}</script></body></html>
)=====";
